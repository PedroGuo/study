{"version":3,"file":"dist.js","sources":["../src/core/eventEmitter.ts","../src/plugins/template/index.ts","../src/utils/index.ts","../src/http/adapter.ts","../src/core/index.ts","../src/plugins/drop.ts"],"sourcesContent":["interface Events {\r\n    [name: string]: [WithFnFunction, Object][]\r\n  }\r\n  \r\n  interface EventTypes {\r\n    [type: string]: string\r\n  }\r\n  \r\ninterface WithFnFunction extends Function {\r\n    fn?: Function\r\n}\r\n\r\nexport class EventEmitter {\r\n    events: Events\r\n    eventTypes: EventTypes\r\n    constructor() {\r\n      this.events = {}\r\n      this.eventTypes = {}\r\n    }\r\n\r\n    on(type: string, fn: Function, context: Object = this) {\r\n      if (!this.events[type]) {\r\n        this.events[type] = []\r\n      }\r\n\r\n      this.events[type].push([fn, context])\r\n      return () => {\r\n        this.off(type, fn)\r\n      }\r\n    }\r\n\r\n    once(type: string, fn: Function, context: Object = this) {\r\n      const magic = (...args: any[]) => {\r\n        this.off(type, magic)\r\n\r\n        fn.apply(context, args)\r\n      }\r\n      magic.fn = fn\r\n\r\n      this.on(type, magic)\r\n      return this\r\n    }\r\n\r\n    off(type?: string, fn?: Function) {\r\n      if (!type && !fn) {\r\n        this.events = {}\r\n        return this\r\n      }\r\n\r\n      if (type) {\r\n        \r\n        if (!fn) {\r\n          this.events[type] = []\r\n          return this\r\n        }\r\n\r\n        let events = this.events[type]\r\n        if (!events) {\r\n          return this\r\n        }\r\n\r\n        let count = events.length\r\n        while (count--) {\r\n          if (\r\n            events[count][0] === fn ||\r\n            (events[count][0] && events[count][0].fn === fn)\r\n          ) {\r\n            events.splice(count, 1)\r\n          }\r\n        }\r\n\r\n        return this\r\n      }\r\n    }\r\n\r\n    trigger(type: string, ...args: any[]) {\r\n      \r\n      let events = this.events[type]\r\n      if (!events) {\r\n        return\r\n      }\r\n\r\n      let len = events.length\r\n      let eventsCopy = Array.from(events)\r\n      let ret\r\n      for (let i = 0; i < len; i++) {\r\n        let event = eventsCopy[i]\r\n        let [fn, context] = event\r\n        if (fn) {\r\n          ret = fn.apply(context, args)\r\n          if (ret === true) {\r\n            return ret\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    destroy() {\r\n      this.events = {}\r\n      this.eventTypes = {}\r\n    }\r\n  }","\r\nexport const defaultTemplate = `\r\n    <div id=\"app\" class=\"upload-demo\">\r\n        <div tabindex=\"0\" class=\"el-upload el-upload--text\">\r\n            <div class=\"el-upload-dragger\">\r\n                <span>\r\n                    <svg t=\"1623763567583\" class=\"icon\" viewBox=\"0 0 1024 1024\" version=\"1.1\"\r\n                        xmlns=\"http://www.w3.org/2000/svg\" p-id=\"1208\" width=\"67\" height=\"67\">\r\n                        <path\r\n                            d=\"M803.786667 414.4a5.333333 5.333333 0 0 1-4.106667-4.053333 304 304 0 0 0-600.746667 50.666666 5.333333 5.333333 0 0 1-4.16 4.96A196.16 196.16 0 0 0 42.666667 660.426667C44.426667 768 134.986667 853.333333 242.666667 853.333333h92.373333a5.333333 5.333333 0 0 0 5.333333-5.333333v-64a5.333333 5.333333 0 0 0-5.333333-5.333333H241.653333c-60.693333 0-114.026667-43.413333-122.986666-103.466667a121.866667 121.866667 0 0 1 95.253333-137.013333l53.333333-11.093334a5.333333 5.333333 0 0 0 4.266667-5.333333l1.706667-54.613333a229.333333 229.333333 0 0 1 453.866666-38.773334L736.533333 474.666667a5.333333 5.333333 0 0 0 4.266667 4.213333l45.973333 8.533333a147.04 147.04 0 0 1-26.08 291.253334H554.666667a5.333333 5.333333 0 0 1-5.333334-5.333334v-182.293333a5.333333 5.333333 0 0 1 9.12-3.786667l48 48a5.333333 5.333333 0 0 0 7.52 0l45.28-45.226666a5.333333 5.333333 0 0 0 0-7.573334l-94.453333-94.4-49.013333-49.066666a5.333333 5.333333 0 0 0-7.573334 0l-49.013333 49.066666-94.293333 94.24a5.333333 5.333333 0 0 0 0 7.573334l45.28 45.226666a5.333333 5.333333 0 0 0 7.52 0l48-48a5.333333 5.333333 0 0 1 9.12 3.786667V848a5.333333 5.333333 0 0 0 5.333333 5.333333h279.626667a221.706667 221.706667 0 0 0 44.16-438.933333z\"\r\n                            p-id=\"1209\"></path>\r\n                    </svg>\r\n\r\n                </span>\r\n\r\n                <div class=\"el-upload__text\">将文件拖到此处，或<em>点击上传</em></div>\r\n            </div>\r\n        </div>\r\n        <ul class=\"el-upload-list\"></ul>\r\n    </div>\r\n`","export function callWithErrorHandling(fn: Function, ctx?: unknown, arg?: unknown) {\r\n  let res\r\n  try {\r\n    arg ? fn(ctx, arg) : fn(ctx)\r\n  } catch (err) {\r\n    // TODO 错误处理\r\n    console.error(err)\r\n  }\r\n  return res\r\n}\r\n\r\nexport function isUndef(v: any): boolean {\r\n  return v === undefined || v === null\r\n}\r\n\r\nexport const isFunction = (val: unknown): val is Function => typeof val === 'function'\r\n\r\nexport const isString = (val: unknown): val is string => typeof val === 'string'\r\n\r\nexport const isBlob = (val: unknown): val is Blob => {\r\n  if (typeof Blob === 'undefined') return false\r\n  return val instanceof Blob || Object.prototype.toString.call(val) === '[object Blob]'\r\n}\r\n\r\nexport const isFile = (val: unknown) => {\r\n  if (typeof File === 'undefined') return false\r\n  return val instanceof File || Object.prototype.toString.call(val) === '[object File]'\r\n}\r\n\r\nexport const dataUriToBlob = (dataUri: string, mimeType?: string) => {\r\n  let arr = dataUri.split(',')\r\n  let mime = mimeType || arr[0].match(/:(.*?);/)![1]\r\n  let bytes = window.atob(arr[1])\r\n  let ab = new ArrayBuffer(bytes.length)\r\n  let ia = new Uint8Array(ab)\r\n  for (let i = 0; i < bytes.length; i++) {\r\n    ia[i] = bytes.charCodeAt(i)\r\n  }\r\n  return new Blob([ab], { type: mime })\r\n}\r\n\r\nexport function warn(msg: string) {\r\n  console.error(`[Upload warn]: ${msg}`)\r\n}\r\n\r\nexport function getElement(el: HTMLElement | string) {\r\n  return (typeof el === 'string' ? document.querySelector(el) : el) as HTMLElement\r\n}\r\n\r\nexport function addEvent(\r\n  el: HTMLElement,\r\n  type: string,\r\n  fn: EventListenerOrEventListenerObject,\r\n  capture?: AddEventListenerOptions\r\n) {\r\n  el.addEventListener(type, fn, {\r\n    passive: false,\r\n    capture: !!capture\r\n  })\r\n\r\n  return () => {\r\n    removeEvent(el, type, fn)\r\n  }\r\n}\r\n\r\nexport function removeEvent(\r\n  el: HTMLElement,\r\n  type: string,\r\n  fn: EventListenerOrEventListenerObject,\r\n  capture?: EventListenerOptions\r\n) {\r\n  el.removeEventListener(type, fn, {\r\n    capture: !!capture\r\n  })\r\n}\r\n","interface AdapterOption  {\r\n    action: string\r\n    body: FormData,\r\n    headers?: object\r\n    withCredentials?: string\r\n    onProgress: (e: Event) => void\r\n    onSuccess: (body: Body) => void\r\n    onError: (e: Error) => void\r\n}\r\n\r\nfunction getError(action: string, xhr: XMLHttpRequest ): Error{\r\n  let msg: string;\r\n  if (xhr.response) {\r\n    msg = `${xhr.response.error || xhr.response}`;\r\n  } else if (xhr.responseText) {\r\n    msg = `${xhr.responseText}`;\r\n  } else {\r\n    msg = `fail to post ${action} ${xhr.status}`;\r\n  }\r\n\r\n  const err = new Error(msg);\r\n  // err['status'] = xhr.status;\r\n  // err['method'] = \"post\";\r\n  // err['url'] = action;\r\n  return err;\r\n}\r\n\r\nfunction getBody(xhr: XMLHttpRequest): Body {\r\n  const text = xhr.responseText || xhr.response;\r\n  if (!text) {\r\n    return text;\r\n  }\r\n\r\n  try {\r\n    return JSON.parse(text);\r\n  } catch (e) {\r\n    return text;\r\n  }\r\n}\r\n\r\n\r\n\r\nfunction upload(option: AdapterOption) {\r\n  const xhr = new XMLHttpRequest();\r\n  const action = option.action;\r\n\r\n  if (xhr.upload) {\r\n    xhr.upload.onprogress = option.onProgress;\r\n  }\r\n\r\n\r\n  xhr.onerror = () => option.onError(getError(action, xhr))\r\n  \r\n\r\n  xhr.onload = function onload() {\r\n    if (xhr.status < 200 || xhr.status >= 300) {\r\n      return option.onError(getError(action, xhr));\r\n    }\r\n\r\n    option.onSuccess(getBody(xhr));\r\n  };\r\n\r\n  xhr.open(\"post\", action, true);\r\n\r\n  if (option.withCredentials && \"withCredentials\" in xhr) {\r\n    xhr.withCredentials = true;\r\n  }\r\n\r\n  const headers = option.headers || {};\r\n\r\n  for (let name in headers) {\r\n    if (headers.hasOwnProperty(name) && headers[name] !== null) {\r\n      xhr.setRequestHeader(name, headers[name]);\r\n    }\r\n  }\r\n  xhr.send(option.body);\r\n  return xhr;\r\n}\r\n\r\n\r\nexport const createAdapter = () => {\r\n  if (typeof XMLHttpRequest !== \"undefined\") {\r\n    return upload\r\n  }\r\n};","import { EventEmitter } from './eventEmitter'\r\nimport { Plugin } from '../interface/plugin'\r\nimport { defaultTemplate } from '../plugins/template/index'\r\nimport { Hooks, HooksType } from '../interface/hooks'\r\nimport { UploadOptions, ElementParam } from '../interface/uploadParams'\r\nimport { callWithErrorHandling, isUndef, warn, getElement, addEvent } from '../utils/index'\r\nimport { createAdapter } from '../http/adapter'\r\n\r\ntype ArraysOf<T> = {\r\n  [K in keyof T]: Array<T[K]>\r\n}\r\n\r\ntype PluginsHooks = ArraysOf<Hooks>\r\n\r\ninterface PluginsMap {\r\n  [key: string]: boolean\r\n}\r\n\r\nconst DEFAULT_OPTIONS: UploadOptions = {\r\n  template: defaultTemplate,\r\n  name: 'file',\r\n  accept: '/image',\r\n  showFileList: true,\r\n  headers: {},\r\n  action: '/index',\r\n  drag: true,\r\n  clipBoard: false,\r\n  listType: 'text',\r\n  autoUpload: true,\r\n  disabled: false,\r\n  limit: -1\r\n}\r\n\r\nexport class UploadConstructor<O = {}> extends EventEmitter {\r\n  static plugins: Plugin[] = []\r\n  static pluginsMap: PluginsMap = {}\r\n  options: UploadOptions\r\n  container!: HTMLElement\r\n  fileList!: File[];\r\n  [key: string]: any\r\n\r\n  private pluginsHooks: PluginsHooks = {}\r\n\r\n  constructor(opt: UploadOptions & O) {\r\n    super()\r\n    this.options = { ...DEFAULT_OPTIONS, ...opt }\r\n    this.init()\r\n  }\r\n\r\n  private init() {\r\n    const { el, template } = this.options\r\n    if (el) {\r\n      this.container = getElement(el)\r\n    }\r\n    if (!this.container) {\r\n      warn('Can not resolve the wrapper DOM.')\r\n      return\r\n    }\r\n    if (template) {\r\n      this.container.innerHTML = template\r\n    }\r\n    this.fileList = []\r\n    this.initPluginHooks()\r\n    this.invokePluginHook('init')\r\n    this.setEventLister()\r\n  }\r\n\r\n  private setEventLister() {\r\n    const { container, pluginsHooks } = this\r\n    const inputElement = this.createInputElement()\r\n    const offUploadFileFn = this.on('uploadFile', this.uploadFile)\r\n    const offClickFn = addEvent(container, 'click', () => {\r\n      inputElement.value = ''\r\n      inputElement.click()\r\n    })\r\n    const offChangeFn = addEvent(inputElement, 'change', (e: Event) => {\r\n      const fileList = (e.target as HTMLInputElement).files\r\n      if (!fileList || !fileList.length) return\r\n      this.fileList = this.fileList.concat(Array.from(fileList))\r\n      this.trigger('uploadFile')\r\n    })\r\n    pluginsHooks.destroy?.push(offClickFn, offChangeFn, offUploadFileFn)\r\n  }\r\n\r\n  private uploadFile() {\r\n    this.invokePluginHook('beforeUpload')\r\n    const { fileList } = this\r\n    const { name, action, headers } = this.options\r\n    const adapter = createAdapter()\r\n    const formData = new FormData()\r\n    fileList.forEach(file => {\r\n      formData.append(name, file)\r\n    })\r\n\r\n    adapter &&\r\n      adapter({\r\n        action,\r\n        headers,\r\n        body: formData,\r\n        onProgress: (e: Event) => {\r\n          this.invokePluginHook('onUpload', e)\r\n        },\r\n        onSuccess() {},\r\n        onError() {}\r\n      })\r\n  }\r\n\r\n  private createInputElement() {\r\n    const { container, options } = this\r\n    const { accept, multiple } = options\r\n    const inputElement: HTMLInputElement = document.createElement('input')\r\n    inputElement.setAttribute('style', 'display: none')\r\n    inputElement.setAttribute('type', 'file')\r\n    inputElement.setAttribute('accept', accept)\r\n    if (multiple) {\r\n      inputElement.setAttribute('multiple', 'multiple')\r\n    }\r\n    container.appendChild(inputElement)\r\n    return inputElement\r\n  }\r\n\r\n  private invokePluginHook(hookType: HooksType, params?: unknown) {\r\n    const invokePluginHooks = this.pluginsHooks[hookType]\r\n    invokePluginHooks?.forEach(hook => {\r\n      if (typeof hook === 'function') {\r\n        callWithErrorHandling(hook, this, params)\r\n      }\r\n    })\r\n  }\r\n\r\n  private initPluginHooks() {\r\n    const hooks: Array<keyof Hooks> = [\r\n      'init',\r\n      'create',\r\n      'beforeUpload',\r\n      'onUpload',\r\n      'afterUpload',\r\n      'destroy'\r\n    ]\r\n    this.pluginsHooks = {\r\n      init: [],\r\n      create: [],\r\n      destroy: [],\r\n      beforeUpload: [],\r\n      afterUpload: [],\r\n      onUpload: []\r\n    }\r\n    const plugins = UploadConstructor.plugins\r\n    for (let i = 0; i < hooks.length; ++i) {\r\n      this.pluginsHooks[hooks[i]] = []\r\n      for (let j = 0; j < plugins.length; ++j) {\r\n        const hook = plugins[j][hooks[i]]\r\n        if (hook !== undefined) {\r\n          ;(this.pluginsHooks[hooks[i]] as any[]).push(hook)\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  static use(plugin: Plugin) {\r\n    const name = plugin.name\r\n    if (isUndef(name)) {\r\n      warn(`Plugin Class must specify plugin's name in static property by 'pluginName' field.`)\r\n      return UploadConstructor\r\n    }\r\n    if (UploadConstructor.pluginsMap[name]) {\r\n      warn(`This plugin has been registered, maybe you need change plugin's name`)\r\n      return UploadConstructor\r\n    }\r\n    UploadConstructor.pluginsMap[name] = true\r\n    UploadConstructor.plugins.push(plugin)\r\n    return UploadConstructor\r\n  }\r\n\r\n  destroy() {\r\n    this.invokePluginHook('destroy')\r\n    UploadConstructor.plugins = []\r\n    UploadConstructor.pluginsMap = {}\r\n    this.pluginsHooks = {}\r\n    this.options = DEFAULT_OPTIONS\r\n  }\r\n\r\n  // 取消上传\r\n  abort() {}\r\n\r\n  // 手动上传\r\n  submit() {\r\n    this.uploadFile()\r\n  }\r\n}\r\n\r\nexport function createUpload<O = {}>(options: UploadOptions & O): UploadConstructor {\r\n  const upload = new UploadConstructor(options)\r\n  return (upload as unknown) as UploadConstructor\r\n}\r\n\r\ncreateUpload.use = UploadConstructor.use\r\ncreateUpload.plugins = UploadConstructor.plugins\r\ncreateUpload.pluginsMap = UploadConstructor.pluginsMap\r\n\r\ntype CreateUpload = typeof createUpload\r\nexport interface UploadFactory extends CreateUpload {\r\n  new <O = {}>(el: ElementParam, options?: UploadOptions & O): UploadConstructor\r\n}\r\n\r\nexport type Upload<O = UploadOptions> = UploadConstructor<O>\r\n\r\nexport const Upload = (createUpload as unknown) as UploadFactory\r\n","import { Plugin } from \"../interface/plugin\"; \r\nimport { Upload } from \"../core\";\r\nimport { addEvent } from '../utils/index'\r\nconst eventLists: Function[] = []\r\n\r\nconst initDrop = (ctx: Upload) => {\r\n    const { container, options: { autoUpload, drag } } = ctx\r\n    if (container && drag) {\r\n        ['dragover', 'drop'].forEach(type => {\r\n            const offEvent = addEvent(container,type, (e: Event) => {\r\n                e.preventDefault()\r\n                if (type === 'drop') {\r\n                    const fileList = (e as any).dataTransfer.files\r\n                    if (!fileList || !fileList.length) return\r\n                    ctx.fileList = ctx.fileList.concat(Array.from(fileList))\r\n                    if (autoUpload) {\r\n                        ctx.trigger('uploadFile')\r\n                    }\r\n                }\r\n            })\r\n            eventLists.push(offEvent)\r\n        })\r\n    }\r\n}\r\n\r\nconst destroy = () => {\r\n    eventLists.forEach(fn => {\r\n        fn && fn()\r\n    })\r\n}\r\n\r\nexport const dropFilePlugin: Plugin = { name: 'dropFile', init: initDrop, destroy }"],"names":[],"mappings":"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"}